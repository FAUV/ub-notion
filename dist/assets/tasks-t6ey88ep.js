import{b as l,u as o,d as y}from"./vendor-query-CfuGqJst.js";import{d as n,i as p}from"./index-uMaUSKow.js";const t={all:["tasks"]};async function c(){return n.tasks.orderBy("title").toArray()}function Q(){return l({queryKey:t.all,queryFn:c,staleTime:6e4})}async function d({id:e,status:s}){const r=await n.tasks.get(e);if(!r)throw new Error("No se encontrÃ³ la tarea a actualizar");const a={...r,status:s};return await n.tasks.put(a),await p({type:"task.upsert",payload:a}),a}function m(){const e=o();return y({mutationFn:d,onMutate:async({id:s,status:r})=>{await e.cancelQueries({queryKey:t.all});const a=e.getQueryData(t.all);return e.setQueryData(t.all,(i=[])=>i.map(u=>u.id===s?{...u,status:r}:u)),{previous:a}},onError:(s,r,a)=>{a!=null&&a.previous&&e.setQueryData(t.all,a.previous)},onSettled:()=>{e.invalidateQueries({queryKey:t.all})}})}export{m as a,t,Q as u};
