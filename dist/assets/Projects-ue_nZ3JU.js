import{u as N,j as e}from"./vendor-query-CfuGqJst.js";import{r as m}from"./vendor-react-Ba_DDsk4.js";import{i as j}from"./importCsv-Dai6I4rs.js";import{V as u}from"./ViewBar-GmxfLOF8.js";import{T as y}from"./Timeline-cZrqngIZ.js";import{u as f,p as b}from"./projects-D-qCoM0Y.js";import"./index-uMaUSKow.js";import"./date-CZKpIZnz.js";import"./parseISO-Clwiv-83.js";import"./vendor-charts-Ci5G67-A.js";const v=["Plan","Active","At Risk","On Hold","Done"];function k({projects:a}){return e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-5 gap-4",children:v.map(r=>{const l=a.filter(s=>s.status===r);return e.jsxs("section",{className:"card p-4 space-y-3",children:[e.jsx("header",{className:"text-xs uppercase tracking-wide text-slate-500 dark:text-slate-400",children:r}),e.jsxs("div",{className:"space-y-3",children:[l.map(s=>e.jsxs("article",{className:"rounded-xl border border-slate-200 dark:border-slate-800 p-3 bg-white/60 dark:bg-slate-950/40",children:[e.jsx("h3",{className:"font-medium text-sm leading-tight",children:s.name}),e.jsxs("dl",{className:"mt-2 space-y-1 text-xs text-slate-500 dark:text-slate-400",children:[s.priority&&e.jsxs("div",{className:"flex justify-between gap-2",children:[e.jsx("dt",{children:"Prioridad"}),e.jsx("dd",{children:s.priority})]}),s.progress!==void 0&&e.jsxs("div",{className:"flex justify-between gap-2",children:[e.jsx("dt",{children:"Progreso"}),e.jsxs("dd",{children:[s.progress,"%"]})]}),s.endDate&&e.jsxs("div",{className:"flex justify-between gap-2",children:[e.jsx("dt",{children:"Entrega"}),e.jsx("dd",{children:s.endDate})]})]})]},s.id)),!l.length&&e.jsx("p",{className:"text-xs text-slate-500 dark:text-slate-500",children:"Sin proyectos"})]})]},r)})})}function M(){const[a,r]=m.useState("list"),l=N(),{data:s=[],isLoading:o}=f(),d=m.useMemo(()=>{const t=s.length,c=s.filter(i=>i.status==="Active").length,x=s.filter(i=>i.status==="At Risk").length,n=s.length?Math.round(s.reduce((i,g)=>i+(g.progress??0),0)/s.length):0;return{total:t,active:c,risk:x,avgProgress:n}},[s]),h=m.useMemo(()=>s.filter(t=>t.startDate&&t.endDate).map(t=>({id:t.id,name:t.name,startDate:t.startDate,endDate:t.endDate,category:t.program})),[s]);async function p(t){var n;const c=(n=t.target.files)==null?void 0:n[0];if(!c)return;const x=await c.text();await j("projects",x),await l.invalidateQueries({queryKey:b.all})}return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h1",{className:"text-xl font-semibold",children:"Proyectos"}),e.jsx("div",{className:"flex items-center gap-2",children:e.jsxs("label",{className:"btn cursor-pointer",children:["Importar CSV",e.jsx("input",{type:"file",accept:".csv",className:"hidden",onChange:p})]})})]}),e.jsxs("section",{className:"grid gap-3 md:grid-cols-4",children:[e.jsxs("article",{className:"card p-4",children:[e.jsx("header",{className:"text-xs uppercase tracking-wide text-slate-500 dark:text-slate-400",children:"Portafolio"}),e.jsx("p",{className:"text-2xl font-semibold mt-2",children:d.total})]}),e.jsxs("article",{className:"card p-4",children:[e.jsx("header",{className:"text-xs uppercase tracking-wide text-slate-500 dark:text-slate-400",children:"Activos"}),e.jsx("p",{className:"text-2xl font-semibold mt-2",children:d.active})]}),e.jsxs("article",{className:"card p-4",children:[e.jsx("header",{className:"text-xs uppercase tracking-wide text-slate-500 dark:text-slate-400",children:"En riesgo"}),e.jsx("p",{className:"text-2xl font-semibold mt-2 text-amber-500",children:d.risk})]}),e.jsxs("article",{className:"card p-4",children:[e.jsx("header",{className:"text-xs uppercase tracking-wide text-slate-500 dark:text-slate-400",children:"Progreso medio"}),e.jsxs("p",{className:"text-2xl font-semibold mt-2",children:[d.avgProgress,"%"]})]})]}),e.jsx(u,{items:[{key:"list",label:"Lista"},{key:"board",label:"Tablero"},{key:"timeline",label:"Cronograma"}],active:a,onChange:r}),o&&e.jsx("div",{className:"card p-4 text-sm opacity-80",children:"Cargando proyectos..."}),a==="list"&&e.jsx("div",{className:"card p-0 overflow-x-auto",children:e.jsxs("table",{className:"min-w-full text-sm",children:[e.jsx("thead",{className:"text-left text-xs uppercase tracking-wide text-slate-500 dark:text-slate-400 border-b border-slate-200 dark:border-slate-800",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-3 font-medium",children:"Proyecto"}),e.jsx("th",{className:"px-4 py-3 font-medium",children:"Estado"}),e.jsx("th",{className:"px-4 py-3 font-medium",children:"Prioridad"}),e.jsx("th",{className:"px-4 py-3 font-medium",children:"Inicio"}),e.jsx("th",{className:"px-4 py-3 font-medium",children:"Fin"}),e.jsx("th",{className:"px-4 py-3 font-medium",children:"Progreso"})]})}),e.jsxs("tbody",{className:"divide-y divide-slate-200 dark:divide-slate-800",children:[s.map(t=>e.jsxs("tr",{className:"hover:bg-slate-50/60 dark:hover:bg-slate-800/60",children:[e.jsxs("td",{className:"px-4 py-3",children:[e.jsx("div",{className:"font-medium",children:t.name}),t.program&&e.jsx("div",{className:"text-xs text-slate-500 dark:text-slate-400 mt-1",children:t.program})]}),e.jsx("td",{className:"px-4 py-3",children:t.status}),e.jsx("td",{className:"px-4 py-3",children:t.priority??"—"}),e.jsx("td",{className:"px-4 py-3",children:t.startDate??"—"}),e.jsx("td",{className:"px-4 py-3",children:t.endDate??"—"}),e.jsx("td",{className:"px-4 py-3",children:t.progress!==void 0?`${t.progress}%`:"—"})]},t.id)),!s.length&&!o&&e.jsx("tr",{children:e.jsx("td",{colSpan:6,className:"px-4 py-6 text-center text-sm opacity-70",children:"No hay proyectos disponibles."})})]})]})}),a==="board"&&e.jsx(k,{projects:s}),a==="timeline"&&e.jsx(y,{items:h,emptyMessage:"No hay proyectos con cronograma definido."})]})}export{M as default};
